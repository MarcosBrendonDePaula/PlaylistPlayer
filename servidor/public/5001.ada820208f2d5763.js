"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[5001],{5001:(X,Z,r)=>{r.r(Z),r.d(Z,{PlayListDownloadPageModule:()=>W});var h=r(6895),I=r(433),n=r(4556),T=r(7551),c=r(655),M=r(3983),i=r(8256),C=r(6841),L=r(9449),x=r(2601),b=r(5126);function A(o,e){if(1&o&&i._UZ(0,"img",17),2&o){const t=i.oxw();i.s9C("alt",t.MusicTocando.data.title),i.s9C("src",t.MusicTocando.data.thumbnail,i.LSH)}}function G(o,e){if(1&o&&i._UZ(0,"img",17),2&o){const t=i.oxw();i.s9C("alt",t.data.title),i.s9C("src",t.data.thumbnail,i.LSH)}}function k(o,e){if(1&o&&(i.TgZ(0,"ion-card-title"),i._uU(1),i.qZA()),2&o){const t=i.oxw();i.xp6(1),i.Oqu(t.MusicTocando.data.title)}}function N(o,e){if(1&o&&(i.TgZ(0,"ion-card-title"),i._uU(1),i.qZA()),2&o){const t=i.oxw();i.xp6(1),i.Oqu(t.data.title)}}function q(o,e){if(1&o){const t=i.EpF();i.TgZ(0,"ion-button",8),i.NdJ("click",function(){i.CHM(t);const l=i.oxw();return i.KtG(l.stop())}),i._UZ(1,"ion-icon",18),i.qZA()}}function O(o,e){if(1&o){const t=i.EpF();i.TgZ(0,"ion-button",8),i.NdJ("click",function(){i.CHM(t);const l=i.oxw();return i.KtG(l.play())}),i._UZ(1,"ion-icon",19),i.qZA()}}function J(o,e){if(1&o){const t=i.EpF();i.TgZ(0,"ion-col",20)(1,"music",21,22),i.NdJ("OnEnd",function(){i.CHM(t);const l=i.oxw();return i.KtG(l.musicaTerminou())}),i.qZA()()}if(2&o){const t=e.$implicit;i.xp6(1),i.Q6J("data",t)}}const U=["*"];let F=(()=>{class o{constructor(t){this.storage=t,this.musicas=[]}load(){var t;return(0,c.mG)(this,void 0,void 0,function*(){null==(yield this.storage.get("musics"))&&(yield this.storage.set("musics",this.musicas)),null==(yield this.storage.get(`playlist_info_${this.data.id}`))&&(yield this.storage.set(`playlist_info_${this.data.id}`,{last_music_played:0,music_time_played:0,times_played:[]})),this.PlaylistInfo=yield this.storage.get(`playlist_info_${this.data.id}`),this.musicas=yield this.storage.get("musics");let s=[],l="";for(l of this.musicas)-1!=this.data.video_ids.indexOf(null!==(t=l.videoId)&&void 0!==t?t:"")&&s.push(l);this.musicas=s})}savePlayListInfo(){return(0,c.mG)(this,void 0,void 0,function*(){yield this.storage.set(`playlist_info_${this.data.id}`,this.PlaylistInfo)})}ngOnInit(){var t,s;return(0,c.mG)(this,void 0,void 0,function*(){yield this.load(),this.tocando=!1,this.tocando_id=null!==(s=null===(t=this.PlaylistInfo)||void 0===t?void 0:t.last_music_played)&&void 0!==s?s:0})}ngAfterViewInit(){this.MusicTocando=this.musicasContainer.toArray()[this.tocando_id]}musicaTerminou(){this.proximo()}loadPosition(){this.MusicTocando=this.musicasContainer.toArray()[this.tocando_id]}initTimer(){return(0,c.mG)(this,void 0,void 0,function*(){this.timer=new Date})}play(){return(0,c.mG)(this,void 0,void 0,function*(){this.initTimer(),this.loadPosition(),yield this.MusicTocando.playPause(),this.MusicTocando.tocando=!0,this.tocando=!0})}stop(){return(0,c.mG)(this,void 0,void 0,function*(){let t=new Date;this.PlaylistInfo.music_time_played+=t.getTime()-this.timer.getTime(),yield this.savePlayListInfo(),this.tocando&&(this.tocando=!1,this.MusicTocando.player.stop(),this.MusicTocando.tocando=!1)})}anterior(){return(0,c.mG)(this,void 0,void 0,function*(){yield this.stop(),this.tocando_id-1==-1&&(this.tocando_id=this.musicasContainer.length-1),this.tocando_id-=1,this.PlaylistInfo.last_music_played=this.tocando_id,yield this.play()})}proximo(){return(0,c.mG)(this,void 0,void 0,function*(){yield this.stop(),this.tocando_id==this.musicasContainer.length-1&&(this.tocando_id=0),this.tocando_id+=1,this.PlaylistInfo.last_music_played=this.tocando_id,yield this.play()})}}return o.\u0275fac=function(t){return new(t||o)(i.Y36(x.Ke))},o.\u0275cmp=i.Xpm({type:o,selectors:[["app-playlist"]],viewQuery:function(t,s){if(1&t&&i.Gf(b.V,5),2&t){let l;i.iGM(l=i.CRH())&&(s.musicasContainer=l)}},inputs:{data:"data"},ngContentSelectors:U,decls:41,vars:8,consts:[["lines","full"],["slot","start"],["col-1",""],["col-10",""],[3,"alt","src",4,"ngIf","ngIfElse"],["elseBlockImg",""],[4,"ngIf","ngIfElse"],["elseBlockTitle",""],["expand","block",3,"click"],["slot","icon-only","name","play-skip-back-sharp"],["expand","block",3,"click",4,"ngIf","ngIfElse"],["elseBlock",""],["slot","icon-only","name","play-skip-forward-sharp"],["value","first"],["slot","header","color","light"],["slot","content",1,"ion-padding"],["sizeXs","12","sizeSm","12","sizeMd","6","sizeLg","4",4,"ngFor","ngForOf"],[3,"alt","src"],["name","pause-circle-outline"],["name","play-circle-outline"],["sizeXs","12","sizeSm","12","sizeMd","6","sizeLg","4"],[3,"data","OnEnd"],["musica",""]],template:function(t,s){if(1&t&&(i.F$t(),i.TgZ(0,"ion-card")(1,"ion-list")(2,"ion-item",0)(3,"ion-badge",1),i._uU(4),i.qZA(),i.TgZ(5,"ion-label"),i._uU(6,"Minutos tocados"),i.qZA(),i.Hsn(7,0,["slot","end"]),i.qZA()(),i.TgZ(8,"ion-row"),i._UZ(9,"ion-col",2),i.TgZ(10,"ion-col",3),i.YNc(11,A,1,2,"img",4),i.YNc(12,G,1,2,"ng-template",null,5,i.W1O),i.qZA(),i._UZ(14,"ion-col",2),i.qZA(),i.TgZ(15,"ion-card-header"),i.YNc(16,k,2,1,"ion-card-title",6),i.YNc(17,N,2,1,"ng-template",null,7,i.W1O),i.qZA(),i.TgZ(19,"ion-card-content")(20,"ion-grid")(21,"ion-row")(22,"ion-col")(23,"ion-button",8),i.NdJ("click",function(){return s.anterior()}),i._UZ(24,"ion-icon",9),i.qZA()(),i.TgZ(25,"ion-col"),i.YNc(26,q,2,0,"ion-button",10),i.YNc(27,O,2,0,"ng-template",null,11,i.W1O),i.qZA(),i.TgZ(29,"ion-col")(30,"ion-button",8),i.NdJ("click",function(){return s.proximo()}),i._UZ(31,"ion-icon",12),i.qZA()()()()(),i.TgZ(32,"ion-accordion-group")(33,"ion-accordion",13)(34,"ion-item",14)(35,"ion-label"),i._uU(36,"Musicas"),i.qZA()(),i.TgZ(37,"div",15)(38,"ion-grid")(39,"ion-row"),i.YNc(40,J,3,1,"ion-col",16),i.qZA()()()()()()),2&t){const l=i.MAs(13),a=i.MAs(18),u=i.MAs(28);i.xp6(4),i.Oqu((s.PlaylistInfo.music_time_played/6e4).toFixed(2)),i.xp6(7),i.Q6J("ngIf",s.tocando)("ngIfElse",l),i.xp6(5),i.Q6J("ngIf",s.tocando)("ngIfElse",a),i.xp6(10),i.Q6J("ngIf",s.tocando)("ngIfElse",u),i.xp6(14),i.Q6J("ngForOf",s.musicas)}},dependencies:[n.We,n.eh,n.yp,n.YG,n.PM,n.FN,n.Zi,n.Dq,n.wI,n.jY,n.gu,n.Ie,n.Q$,n.q_,n.Nd,h.sg,h.O5,b.V]}),o})();const Y=["viewPlayList"],z=["DownloadMusic"];function Q(o,e){if(1&o&&(i.TgZ(0,"ion-item")(1,"ion-label"),i._uU(2),i.qZA()()),2&o){const t=e.$implicit;i.xp6(2),i.Oqu(null==t||null==t.snippet?null:t.snippet.title)}}function E(o,e){if(1&o){const t=i.EpF();i.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",9)(3,"ion-button",10),i.NdJ("click",function(){i.CHM(t);const l=i.oxw();return i.KtG(l.cancel())}),i._uU(4,"Cancel"),i.qZA()(),i.TgZ(5,"ion-title"),i._uU(6),i.qZA(),i.TgZ(7,"ion-buttons",11)(8,"ion-button",12),i.NdJ("click",function(){i.CHM(t);const l=i.oxw();return i.KtG(l.confirm())}),i._uU(9,"Confirm"),i.qZA()()()(),i.TgZ(10,"ion-content",13)(11,"ion-card"),i._UZ(12,"img",14)(13,"ion-card-header"),i.TgZ(14,"ion-card-content")(15,"ion-item")(16,"ion-list",15),i.YNc(17,Q,3,1,"ion-item",16),i.qZA()()()()()}if(2&o){const t=i.oxw();i.xp6(6),i.Oqu(null==t.model_vars||null==t.model_vars.playlist_info||null==t.model_vars.playlist_info.snippet?null:t.model_vars.playlist_info.snippet.title),i.xp6(2),i.Q6J("strong",!0),i.xp6(4),i.s9C("src",null==t.model_vars||null==t.model_vars.playlist_info||null==t.model_vars.playlist_info.snippet||null==t.model_vars.playlist_info.snippet.thumbnails||null==t.model_vars.playlist_info.snippet.thumbnails.maxres?null:t.model_vars.playlist_info.snippet.thumbnails.maxres.url,i.LSH),i.xp6(4),i.Q6J("inset",!0),i.xp6(1),i.Q6J("ngForOf",t.videos)}}function H(o,e){if(1&o){const t=i.EpF();i.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",9)(3,"ion-button",10),i.NdJ("click",function(){i.CHM(t);const l=i.oxw();return i.KtG(l.cancelDownload())}),i._uU(4,"Parar"),i.qZA()()()(),i.TgZ(5,"ion-content",13)(6,"ion-card"),i._UZ(7,"img",14)(8,"ion-progress-bar",17),i.TgZ(9,"ion-card-header")(10,"ion-card-title"),i._uU(11),i.qZA(),i.TgZ(12,"ion-card-subtitle"),i._uU(13),i.qZA()(),i.TgZ(14,"ion-card-content"),i._UZ(15,"ion-progress-bar",18),i.qZA()()()}if(2&o){const t=i.oxw();i.xp6(7),i.s9C("src",null==t.model_vars||null==t.model_vars.video_atual||null==t.model_vars.video_atual.snippet||null==t.model_vars.video_atual.snippet.thumbnails||null==t.model_vars.video_atual.snippet.thumbnails.maxres?null:t.model_vars.video_atual.snippet.thumbnails.maxres.url,i.LSH),i.xp6(1),i.Q6J("value",null==t.model_vars?null:t.model_vars.atual_download_progress),i.xp6(3),i.hij("",t.model_vars.cancelar?"PARANDO":"DOWNLOADING"," ..."),i.xp6(2),i.Oqu(null==t.model_vars||null==t.model_vars.video_atual||null==t.model_vars.video_atual.snippet?null:t.model_vars.video_atual.snippet.title),i.xp6(2),i.Q6J("buffer",0)("value",t.model_vars.progress)}}const S=function(){return["playlist"]};function $(o,e){if(1&o){const t=i.EpF();i.TgZ(0,"ion-col",19)(1,"app-playlist",20)(2,"ion-buttons",11)(3,"ion-button",21),i.NdJ("click",function(){const a=i.CHM(t).index,u=i.oxw();return i.KtG(u.removerPlayList(a))}),i._UZ(4,"ion-icon",22),i.qZA()()()()}if(2&o){const t=e.$implicit;i.Q6J("ngClass",i.DdM(3,S)),i.xp6(1),i.Q6J("data",t),i.xp6(2),i.Q6J("strong",!0)}}const K=[{path:"",component:(()=>{class o{constructor(t,s,l){this.ytbInfo=t,this.YtbMusicDownload=s,this.storage=l,this.musicas=[],this.musicas_ids=[],this.playlistId="",this.playlists=[],this.videos=[],this.model_vars={playlist_info:{},playlist_ids:[],video_atual:{},atual_download_progress:0,img_source:"",title:"",author:"",progress:.1,cancelar:!1}}getPlayListLink(t){var s,l;let u=(null!==(s=t.split("https://www.youtube.com/watch?")[1])&&void 0!==s?s:"").split("&"),d="";for(let m of u)-1!=m.indexOf("list=")&&(d=null!==(l=m.split("list=")[1])&&void 0!==l?l:"");return d}find(){return(0,c.mG)(this,void 0,void 0,function*(){if(this.searchbar.value){let t=this.searchbar.value,s=this.getPlayListLink(t);""!=s&&(t=s);let l=yield this.ytbInfo.getPlayList(t),a=yield this.ytbInfo.getPlayListItems(t);this.playlistId=t,(null==a?void 0:a.items.length)>0&&(this.model_vars.playlist_info=null==l?void 0:l.items[0],this.videos=null==a?void 0:a.items,this.modal.present())}})}save(){return(0,c.mG)(this,void 0,void 0,function*(){yield this.storage.set("playlists",this.playlists),yield this.storage.set("musics",this.musicas)})}checkifExist(t){return!1}ngOnInit(){return(0,c.mG)(this,void 0,void 0,function*(){null==(yield this.storage.get("playlists"))&&(yield this.storage.set("playlists",this.playlists)),null==(yield this.storage.get("musics"))&&(yield this.storage.set("musics",this.musicas)),this.musicas=yield this.storage.get("musics");for(let t of this.musicas)this.musicas_ids.push(t.videoId);this.playlists=yield this.storage.get("playlists")})}cancel(){this.modal.dismiss(null,"cancel")}cancelDownload(){this.model_vars.cancelar=!0,this.modal.dismiss(null,"cancel")}removerPlayList(t){return(0,c.mG)(this,void 0,void 0,function*(){this.playlists.splice(t,1),yield this.storage.set("playlists",this.playlists)})}confirm(){return(0,c.mG)(this,void 0,void 0,function*(){this.downloadPlayList()})}onWillDismiss(t){console.log(t)}download_music(t){var s,l,a,u;return(0,c.mG)(this,void 0,void 0,function*(){let d=yield this.YtbMusicDownload.getMusic(t);if(null==d)return;for(;"finished"!=d.stats;){let p=null===(s=d.progress)||void 0===s?void 0:s.estimative,v=null!==(a=null===(l=d.progress)||void 0===l?void 0:l.percentage)&&void 0!==a?a:1;this.model_vars.atual_download_progress=.01*v,null==p&&(p=1),yield new Promise(g=>setTimeout(g,60*p*1e3/8)),d=yield this.YtbMusicDownload.getMusic(t)}let m=M.s.compress(null!==(u=d.file)&&void 0!==u?u:"");yield this.storage.set(`m-c-${d.videoId}`,m),d.file=`m-c-${d.videoId}`,this.musicas.push(d),this.save(),this.model_vars.atual_download_progress=0})}downloadPlayList(){var t,s,l,a,u,d,m,p,v,g,f,y,P,w;return(0,c.mG)(this,void 0,void 0,function*(){this.model_vars.cancelar=!1,this.model_vars.playlist_ids=[],this.modalMusicDownload.present(),this.modal.dismiss();let D=1;for(let _ of this.videos){if(this.model_vars.cancelar)return void this.modalMusicDownload.dismiss();this.modalMusicDownload.isOpen||this.modalMusicDownload.present(),this.model_vars.progress=D/this.videos.length,this.model_vars.video_atual=_,-1==this.musicas_ids.indexOf(null===(s=null===(t=null==_?void 0:_.snippet)||void 0===t?void 0:t.resourceId)||void 0===s?void 0:s.videoId)?yield this.download_music(null===(a=null===(l=null==_?void 0:_.snippet)||void 0===l?void 0:l.resourceId)||void 0===a?void 0:a.videoId):console.log(`${null===(d=null===(u=null==_?void 0:_.snippet)||void 0===u?void 0:u.resourceId)||void 0===d?void 0:d.videoId} ja existe`),this.model_vars.playlist_ids.push(null===(p=null===(m=null==_?void 0:_.snippet)||void 0===m?void 0:m.resourceId)||void 0===p?void 0:p.videoId),D+=1}let B={title:null===(g=null===(v=this.model_vars.playlist_info)||void 0===v?void 0:v.snippet)||void 0===g?void 0:g.title,video_ids:this.model_vars.playlist_ids,videos:[],thumbnail:null===(w=null===(P=null===(y=null===(f=this.model_vars.playlist_info)||void 0===f?void 0:f.snippet)||void 0===y?void 0:y.thumbnails)||void 0===P?void 0:P.high)||void 0===w?void 0:w.url,id:this.playlistId};this.playlists.push(B),this.save(),this.modalMusicDownload.dismiss()})}}return o.\u0275fac=function(t){return new(t||o)(i.Y36(C.I),i.Y36(L.s),i.Y36(x.Ke))},o.\u0275cmp=i.Xpm({type:o,selectors:[["app-play-list-download"]],viewQuery:function(t,s){if(1&t&&(i.Gf(Y,7),i.Gf(z,7),i.Gf(n.VI,5)),2&t){let l;i.iGM(l=i.CRH())&&(s.modal=l.first),i.iGM(l=i.CRH())&&(s.modalMusicDownload=l.first),i.iGM(l=i.CRH())&&(s.searchbar=l.first)}},decls:21,vars:1,consts:[["fixed",""],["size","10"],["value","RDYxjMVR7t36E","cancel-button-text","Donwload","cancel-button-icon","trash","placeholder","PlayListId"],["size","2"],["expand","block",3,"click"],[3,"willDismiss"],["viewPlayList",""],["DownloadMusic",""],["sizeXs","12","sizeSm","12","sizeMd","6","sizeLg","6","class","ion-border",3,"ngClass",4,"ngFor","ngForOf"],["slot","start"],["fill","solid","color","danger",3,"click"],["slot","end"],["fill","solid","color","success",3,"strong","click"],[1,"ion-padding"],["alt","",3,"src"],[3,"inset"],[4,"ngFor","ngForOf"],[3,"value"],[3,"buffer","value"],["sizeXs","12","sizeSm","12","sizeMd","6","sizeLg","6",1,"ion-border",3,"ngClass"],[3,"data"],["fill","solid","color","danger",3,"strong","click"],["name","trash"]],template:function(t,s){1&t&&(i.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),i._uU(3,"PlayListDownload"),i.qZA()()(),i.TgZ(4,"ion-content")(5,"ion-grid",0)(6,"ion-row")(7,"ion-col",1),i._UZ(8,"ion-searchbar",2),i.qZA(),i.TgZ(9,"ion-col",3)(10,"ion-button",4),i.NdJ("click",function(){return s.find()}),i._uU(11," Buscar "),i.qZA()()()(),i.TgZ(12,"ion-modal",5,6),i.NdJ("willDismiss",function(a){return s.onWillDismiss(a)}),i.YNc(14,E,18,5,"ng-template"),i.qZA(),i.TgZ(15,"ion-modal",5,7),i.NdJ("willDismiss",function(a){return s.onWillDismiss(a)}),i.YNc(17,H,16,6,"ng-template"),i.qZA(),i.TgZ(18,"ion-grid",0)(19,"ion-row"),i.YNc(20,$,5,4,"ion-col",8),i.qZA()()()),2&t&&(i.xp6(20),i.Q6J("ngForOf",s.playlists))},dependencies:[n.YG,n.Sm,n.PM,n.FN,n.Zi,n.tO,n.Dq,n.wI,n.W2,n.jY,n.Gu,n.gu,n.Ie,n.Q$,n.q_,n.X7,n.Nd,n.VI,n.wd,n.sr,n.ki,n.j9,h.mk,h.sg,F]}),o})()}];let R=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=i.oAB({type:o}),o.\u0275inj=i.cJS({imports:[T.Bz.forChild(K),T.Bz]}),o})();var j=r(5642);let W=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=i.oAB({type:o}),o.\u0275inj=i.cJS({imports:[n.Pc,h.ez,I.u5,R,j.K]}),o})()}}]);